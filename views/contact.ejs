<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign In - EmotoHI</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/styles.css">
    <link rel="icon" href="/images/top%20icon.png" type="image/png">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <a class="logo" href="/">
                <img src="/images/2nd%20brand.png" alt="EmotoHI" class="logo-text-image">
            </a>
            <ul class="nav-links">
                <li><a href="/">Home</a></li>
                <li><a href="/products">Products</a></li>
                <li><a href="/contact" class="active">Sign In</a></li>
                <li class="nav-search-item">
                    <form class="site-search" action="/products" method="get">
                        <button type="submit" aria-label="Search">
                            <svg width="17" height="16" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" viewBox="0 0 16 16">
                                <path d="M7 12a5 5 0 1 0 0-10 5 5 0 0 0 0 10Zm7 2-3-3" stroke="currentColor" stroke-width="1.4" stroke-linecap="round" stroke-linejoin="round"></path>
                            </svg>
                        </button>
                        <input class="site-search-input" name="q" placeholder="Search" type="text" autocomplete="off">
                        <button class="site-search-reset" type="reset" aria-label="Clear search">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                                <path stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"></path>
                            </svg>
                        </button>
                    </form>
                </li>
                <div class="theme-switcher">
                    <button class="theme-toggle" onclick="toggleThemeDropdown()" aria-label="Theme" data-tooltip="Theme">
                        <span class="theme-icon" id="themeIcon"></span>
                    </button>
                    <div class="theme-dropdown" id="themeDropdown">
                        <button class="theme-option" data-theme="system" data-tooltip="System" aria-label="System" onclick="setTheme('system')">
                            <span class="theme-option-icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <rect x="3" y="4" width="18" height="12" rx="2"></rect>
                                    <path d="M8 20h8"></path>
                                </svg>
                            </span>
                        </button>
                        <button class="theme-option" data-theme="light" data-tooltip="Light" aria-label="Light" onclick="setTheme('light')">
                            <span class="theme-option-icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <circle cx="12" cy="12" r="4"></circle>
                                    <path d="M12 2v2M12 20v2M2 12h2M20 12h2M4.9 4.9l1.4 1.4M17.7 17.7l1.4 1.4M4.9 19.1l1.4-1.4M17.7 6.3l1.4-1.4"></path>
                                </svg>
                            </span>
                        </button>
                        <button class="theme-option" data-theme="dark" data-tooltip="Dark" aria-label="Dark" onclick="setTheme('dark')">
                            <span class="theme-option-icon">
                                <svg viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M21 14.5A9 9 0 1 1 9.5 3 7 7 0 0 0 21 14.5Z"></path>
                                </svg>
                            </span>
                        </button>
                    </div>
                </div>
                <button class="cart-icon" onclick="openCart()">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="9" cy="21" r="1"></circle>
                        <circle cx="20" cy="21" r="1"></circle>
                        <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                    </svg>
                </button>
            </ul>
        </div>
    </nav>

    <!-- Sign In Section -->
    <section class="signin-section">
        <div class="signin-shell">
            <div class="signin-card">
                <div class="signin-card-header">
                    <h3>Sign in</h3>
                    <p>Use your email and password to continue.</p>
                </div>
                <form class="signin-form">
                    <div class="form-group">
                        <label for="signinEmail">Email</label>
                        <input type="email" id="signinEmail" name="signinEmail" placeholder="you@email.com" required>
                    </div>
                    <div class="form-group">
                        <label for="signinPassword">Password</label>
                        <input type="password" id="signinPassword" name="signinPassword" placeholder="Enter your password" required>
                    </div>
                    <div class="signin-row">
                        <label class="signin-checkbox">
                            <input type="checkbox" name="remember"> Remember me
                        </label>
                        <a class="signin-link" href="#">Forgot password?</a>
                    </div>
                    <button type="submit" class="signin-primary">Sign in</button>
                    <button type="button" class="signin-secondary">Create account</button>
                </form>
            </div>
        </div>
    </section>



    <!-- Cart Sidebar -->
    <div id="cartSidebar" class="cart-sidebar">
        <div class="cart-header">
            <h3>Cart</h3>
            <button class="cart-close" onclick="closeCart()">&times;</button>
        </div>
        <div class="cart-items" id="cartItems">
            <p class="empty-cart">Your cart is empty</p>
        </div>
        <div class="cart-footer">
            <div class="cart-total">
                <span>Total:</span>
                <span id="cartTotal">$0.00</span>
            </div>
            <button class="checkout-btn" onclick="checkout()">Checkout</button>
        </div>
    </div>
    <div id="cartOverlay" class="cart-overlay" onclick="closeCart()"></div>

    <!-- TOS Modal -->
    <div id="tosOverlay" class="tos-overlay">
        <div class="tos-modal" role="dialog" aria-modal="true" aria-labelledby="tosTitle">
            <h3 id="tosTitle">Terms of Service</h3>
            <p>By using this site, you agree to the terms below.</p>
            <ul>
                <li>All sales are final. No refunds or exchanges.</li>
                <li>Products are sold as-is and installed at your own risk.</li>
                <li>EmotoHI is not responsible for damage, injury, or misuse.</li>
                <li>Local pickup/meetup only unless otherwise arranged.</li>
            </ul>
            <details class="tos-more">
                <summary>See more</summary>
                <div class="tos-more-content">
                    <p>Final sale means we do not offer refunds, returns, or exchanges for any reason, including fitment, change of mind, or installation issues.</p>
                    <p>Products are provided as-is. Any implied warranties are disclaimed to the fullest extent permitted by law. You are responsible for verifying fitment before purchase.</p>
                    <p>Installation, setup, and use are your responsibility. Improper installation or use can cause damage or injury. Use all products at your own risk.</p>
                    <p>EmotoHI is not liable for indirect, incidental, or consequential damages related to purchase, installation, or use of products.</p>
                    <p>Local meetup or pickup only unless otherwise agreed in writing. Delivery windows are estimates and may change.</p>
                    <p>Prices, availability, and descriptions may change at any time. Errors may be corrected and orders may be canceled if needed.</p>
                    <p>By continuing, you confirm you are at least 18 years old or have permission from a parent or guardian.</p>
                </div>
            </details>
            <div class="tos-actions">
                <button class="tos-btn" onclick="declineTos()">Disagree</button>
                <button class="tos-btn primary" onclick="acceptTos()">I Agree</button>
            </div>
        </div>
    </div>

    <script>
        let cart = [];
        const CART_STORAGE_KEY = 'emotohi_cart';

        function saveCart() {
            try {
                sessionStorage.setItem(CART_STORAGE_KEY, JSON.stringify(cart));
            } catch (error) {
                console.warn('Unable to save cart:', error);
            }
        }

        function loadCart() {
            try {
                const raw = sessionStorage.getItem(CART_STORAGE_KEY);
                if (!raw) return;
                const parsed = JSON.parse(raw);
                if (Array.isArray(parsed)) {
                    cart = parsed;
                }
            } catch (error) {
                console.warn('Unable to load cart:', error);
            }
            updateCartDisplay();
        }

        // Theme Management
        function toggleThemeDropdown() {
            const dropdown = document.getElementById('themeDropdown');
            dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
        }

        function setTheme(theme) {
            localStorage.setItem('theme', theme);
            applyTheme(theme);
            toggleThemeDropdown();
            updateThemeOptions();
        }

        function applyTheme(theme) {
            let isDark = false;

            if (theme === 'system') {
                isDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            } else if (theme === 'dark') {
                isDark = true;
            }

            document.body.classList.toggle('dark-theme', isDark);
            updateLogo(isDark);
        }

        function updateLogo(isDark) {
            const logoImage = document.querySelector('.logo-image');
            if (!logoImage) return;

            logoImage.src = isDark ? '/images/brand%20white.png' : '/images/brand.png';
        }

        function updateThemeOptions() {
            const currentTheme = localStorage.getItem('theme') || 'system';
            document.querySelectorAll('.theme-option').forEach(option => {
                option.classList.remove('active');
                if (option.dataset.theme === currentTheme) {
                    option.classList.add('active');
                }
            });

            const themeIcon = document.getElementById('themeIcon');
            if (themeIcon) {
                const iconMap = {
                    system: "<svg viewBox='0 0 24 24' aria-hidden='true'><rect x='3' y='4' width='18' height='12' rx='2'></rect><path d='M8 20h8'></path></svg>",
                    light: "<svg viewBox='0 0 24 24' aria-hidden='true'><circle cx='12' cy='12' r='4'></circle><path d='M12 2v2M12 20v2M2 12h2M20 12h2M4.9 4.9l1.4 1.4M17.7 17.7l1.4 1.4M4.9 19.1l1.4-1.4M17.7 6.3l1.4-1.4'></path></svg>",
                    dark: "<svg viewBox='0 0 24 24' aria-hidden='true'><path d='M21 14.5A9 9 0 1 1 9.5 3 7 7 0 0 0 21 14.5Z'></path></svg>"
                };
                themeIcon.innerHTML = iconMap[currentTheme];
            }
        }

        function loadTheme() {
            const savedTheme = localStorage.getItem('theme') || 'system';
            applyTheme(savedTheme);
            updateThemeOptions();
        }

        // Close dropdown when clicking outside
        window.addEventListener('click', function(e) {
            if (!e.target.matches('.theme-toggle') && !e.target.closest('.theme-switcher')) {
                const dropdown = document.getElementById('themeDropdown');
                if (dropdown) dropdown.style.display = 'none';
            }
        });

        // Listen for system theme changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
            const savedTheme = localStorage.getItem('theme') || 'system';
            if (savedTheme === 'system') {
                applyTheme('system');
            }
        });

        // Load theme on page load
        loadTheme();

        function openCart() {
            document.getElementById('cartSidebar').classList.add('open');
            document.getElementById('cartOverlay').classList.add('open');
        }

        function closeCart() {
            document.getElementById('cartSidebar').classList.remove('open');
            document.getElementById('cartOverlay').classList.remove('open');
        }

        function updateCartDisplay() {
            const cartItemsContainer = document.getElementById('cartItems');
            const cartTotalElement = document.getElementById('cartTotal');
            
            if (cart.length === 0) {
                cartItemsContainer.innerHTML = '<p class="empty-cart">Your cart is empty</p>';
                cartTotalElement.textContent = '$0.00';
                saveCart();
                return;
            }
            
            let total = 0;
            cartItemsContainer.innerHTML = cart.map(item => {
                total += item.total;
                return `
                    <div class="cart-item">
                        <div class="cart-item-info">
                            <p class="cart-item-name">${item.name}</p>
                            <p class="cart-item-details">Qty: ${item.quantity} × $${item.price.toFixed(2)}</p>
                        </div>
                        <div class="cart-item-actions">
                            <p class="cart-item-total">$${item.total.toFixed(2)}</p>
                            <button class="cart-item-remove" onclick="removeFromCart(${item.id})">×</button>
                        </div>
                    </div>
                `;
            }).join('');
            
            cartTotalElement.textContent = '$' + total.toFixed(2);
            saveCart();
        }

        function removeFromCart(itemId) {
            cart = cart.filter(item => item.id !== itemId);
            updateCartDisplay();
        }

        function checkout() {
            if (cart.length === 0) {
                alert('Your cart is empty!');
                return;
            }

            saveCart();
            window.location.href = '/checkout';
        }

        function showTos() {
            document.getElementById('tosOverlay').classList.add('open');
            document.body.classList.add('tos-open');
        }

        function acceptTos() {
            localStorage.setItem('tosAccepted', 'true');
            document.getElementById('tosOverlay').classList.remove('open');
            document.body.classList.remove('tos-open');
        }

        function declineTos() {
            window.location.href = 'about:blank';
            window.close();
        }

        window.addEventListener('DOMContentLoaded', function() {
            loadCart();
            if (localStorage.getItem('tosAccepted') !== 'true') {
                showTos();
            }
        });
    </script>
</body>
</html>
